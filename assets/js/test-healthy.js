
const listTest = [
    {
      id: 1,
      title: "Bệnh Tiểu Đường",
      img: 'assets/img/imggif.gif',
      questions: [
        {
          idQ: 1,
          ask: "Gia đình bạn có ai có lịch sử về bệnh tiểu đường không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Bạn có thường xuyên cảm thấy khát và nhiều nước hơn bình thường không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Bạn có thường xuyên đi tiểu vào ban đêm không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 4,
          ask: "Bạn có cảm giác đói và thèm ăn liên tục không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 5,
          ask: "Bạn có tăng cân đột ngột không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 6,
          ask: "Bạn có bị chậm lành vết loét hoặc bị nhiễm trùng thường xuyên không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 7,
          ask: "Bạn có cảm thấy mệt mỏi không rõ lý do?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
      ],
    },
    {
      id: 2,
      title: "Thiếu dinh dưỡng",
      img: 'assets/img/Test/cau1.gif',
      questions: [
        {
          idQ: 1,
          ask: "Bạn có thường xuyên cảm thấy mệt mỏi và suy nhược nhưng không rõ lý do?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Cân nạng của bạn có bị giảm đột ngột không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Da của bạn có biểu hiện khô, nứt nẻ, hoặc có vấn đề khác không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 4,
          ask: "Bạn có thường xuyên bị đau bụng, tiêu chảy, hoặc khó tiêu hóa không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 5,
          ask: "Có những thay đổi trong khẩu phần ăn hàng ngày của bạn không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 6,
          ask: "Móng của bạn có giòn, dễ gãy không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 7,
          ask: "Bạn có thường xuyên cảm thấy buồn nôn, mệt mỏi sau khi ăn không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
      ],
    },
    {
      id: 3,
      title: "Thiếu máu",
      img: 'assets/img/Test/cau1.gif',
      questions: [
        {
          idQ: 1,
          ask: "Bạn có cảm giác mệt mỏi và suy nhược không lý do rõ ràng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Bạn có thường xuyên có cảm giác hoặc đau đầu không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Bạn có biểu hiện da hoặc niêm mạc nhợt nhạt không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 4,
          ask: "Có những triệu chứng như đau ngực, thở khó khăn, hoặc nhồi máu cơ tim không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 5,
          ask: "Bạn có thường xuyên bị chói mắt không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 6,
          ask: "Có những triệu chứng như chuột rút cơ, giảm cảm giác, hoặc co giật không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
      ],
    },
    {
      id: 4,
      title: "Bệnh Trầm Cảm",
      img: 'assets/img/Test/cau5.gif',
      questions: [
        {
          idQ: 1,
          ask: "Bạn có thường xuyên cảm thấy buồn chán hoặc trống rỗng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Có những khoảnh khắc nào bạn cảm thấy hạnh phúc hoặc thích thú không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Bạn có thường xuyên cảm thấy mệt mỏi và thiếu năng lượng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 4,
          ask: "Có những hoạt động nào bạn thường xuyên từ chối tham gia vì cảm giác mệt mỏi?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 5,
          ask: "Bạn có khó ngủ, hay thức giấc giữa đêm không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 6,
          ask: "Bạn có cảm giác không muốn nói chuyện với mọi người xung quanh không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        
      ],
    },
    {
      id: 5,
      title: "Bệnh Mãn Tính",
      img: 'assets/img/Test/cau2.gif',
      questions: [
        {
          idQ: 1,
          ask: "Bạn có cảm giác đau răng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Bạn cảm giác ê nú không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Bạn thấy hôi miệng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
      ],
    },
    {
      id: 6,
      title: "Bệnh sổ mũi",
      img: 'assets/img/Test/cau4.gif',
      questions: [
        {
          idQ: 1,
          ask: "Bạn có cảm giác sổ mũi không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 2,
          ask: "Bạn cảm giác chảy nước mũi không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
        {
          idQ: 3,
          ask: "Bạn thấy đau họng không?",
          answer: ["Có", "Không"],
          correct: ["Có"],
        },
      ],
    },
  ];
  
  let currentTestId = null;
  let currentQuestionIndex = 0;
  let soCauTraLoiDung = 0;
  
  function showQuestion(testId, viTriCauHoi) {
    const baiTestHienTai = listTest.find((item) => item.id === testId);
  
    if (baiTestHienTai && baiTestHienTai.questions.length > 0) {
      const cauHoiHienTai = baiTestHienTai.questions[viTriCauHoi];
  
      document.querySelector(".modal-body").innerHTML = `
        <h3 class="question">${cauHoiHienTai.ask}</h3>
        <div class="btn">${cauHoiHienTai.answer
          .map(
            (ans, idx) =>
              `<button class="btn btn-primary m-3" onclick="handleTraLoiCauHoi(${idx})">${ans}</button>`
          )
          .join("")}</div>
      `;
    } else {
      showDapAn();
    }
  }
  
  function handleTraLoiCauHoi(viTriCauTraLoi) {
    const baiTestHienTai = listTest[currentTestId - 1];
    const cauHoiHienTai = baiTestHienTai.questions[currentQuestionIndex];
    const cauTraLoiDung = cauHoiHienTai.correct.includes(
      cauHoiHienTai.answer[viTriCauTraLoi]
    );
  
    if (cauTraLoiDung) {
      soCauTraLoiDung++;
    }
  
    currentQuestionIndex++;
    if (
      currentTestId !== null &&
      currentQuestionIndex < baiTestHienTai.questions.length
    ) {
      showQuestion(currentTestId, currentQuestionIndex);
    } else {
      showDapAn();
    }
  }
  
  function showDapAn() {
    let ketQua = "";
    if (soCauTraLoiDung <= 2) {
      ketQua = "Bạn hoàn toàn khỏe mạnh";
    } else if (soCauTraLoiDung < 5) {
      ketQua = "Bạn có một vài triệu chứng, cần lưu ý sức khỏe hơn";
    } else {
      ketQua = "Bạn cần đến trung tâm y tế để được kiểm tra kỹ hơn";
    }
    document.querySelector(".modal-body").innerHTML = ketQua;
  
    currentTestId = null;
    currentQuestionIndex = 0;
    soCauTraLoiDung = 0;
  
    let myModal = new bootstrap.Modal(document.getElementById("exampleModal"));
    myModal.hide();
  }
  
  function handleEventClick(testId) {
    currentTestId = testId;
    showQuestion(testId, currentQuestionIndex);
  
    let myModal = new bootstrap.Modal(document.getElementById("exampleModal"));
    myModal.show();
  }
  
  listTest.forEach((item) => {
    const testItem = document.createElement("div");
    testItem.className = "test-item";
    testItem.innerHTML = `
      <img src=${item.img} />
      <h4>Số: ${item.id} - ${item.title}</h4>
    `;
    testItem.setAttribute("data-id", item.id);
    testItem.addEventListener("click", () => handleEventClick(item.id));
    document.querySelector(".list-test-item").appendChild(testItem);
  });
  